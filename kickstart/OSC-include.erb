<%#
kind: snippet
name: OSC - include
oses:
- CentOS
- Fedora
- RedHat
- RHEL Server
%>
<%# This template defines useful variables to use else where %>
<%
@tftp_boot_prefix = @host.params['tftp_boot_prefix'] || ''

@nfsroot_ro_hostgroups = [
  'base/owens/compute',
  'base/owens/login',
]
@nfsroot_rw_hostgroups = [
  'base/owens/rw'
]
@nfsroot_ro_hosts = [

]

if @host.hostgroup.present? &&
  ((@nfsroot_ro_hostgroups.include?(@host.hostgroup.to_s) || @nfsroot_ro_hosts.include?(@host.name)) ||
    (@nfsroot_rw_hostgroups.include?(@host.hostgroup.to_s) && ! @host.build?))
  @nfsroot = true
else
  @nfsroot = false
end

if @host.hostgroup.present?
  if @nfsroot_ro_hostgroups.include?(@host.hostgroup.to_s) || @nfsroot_ro_hosts.include?(@host.name)
    @nfsroot_ro = true
    @nfsroot_rw = false
  elsif @nfsroot_rw_hostgroups.include?(@host.hostgroup.to_s)
    @nfsroot_ro = false
    @nfsroot_rw = true
  else
    @nfsroot_ro = false
    @nfsroot_rw = false
  end
end

if @nfsroot && @host.hostgroup.to_s =~ /owens/
  @nfsroot_host   = @host.params['nfsroot_host'] || '10.11.200.3'
  @nfsroot_path   = @host.params['nfsroot_path'] || '/owens_root_rhel72_0'
  @nfsroot_opts   = @host.params['nfsroot_opts'] || 'vers=3,tcp,rw,nfsvers=3,async,rsize=65536,wsize=65536'
  @nfsroot_kernel_version = @host.params['nfsroot_kernel_version']
  if @nfsroot_kernel_version
    @nfsroot_kernel = @host.params['nfsroot_kernel'] || "nfsroot/vmlinuz-#{@nfsroot_kernel_version}"
    @nfsroot_initrd = @host.params['nfsroot_initrd'] || "nfsroot/initramfs-#{@nfsroot_kernel_version}.img"
  else
    @nfsroot_kernel = @host.params['nfsroot_kernel'] || @kernel
    @nfsroot_initrd = @host.params['nfsroot_initrd'] || @initrd
  end
end

-%>
